# Gmail Archiver

A Python script that downloads and archives all emails from a Gmail account to local storage, preserving the complete content, structure, and attachments.

## Features

- **Complete Email Archive**: Downloads all emails from your Gmail account since creation
- **Preserves Structure**: Maintains Gmail's folder/label organization
- **Chronological Organization**: Sorts emails by year and month
- **Full Metadata**: Saves emails in .eml format, preserving headers, content, and formatting
- **Attachment Handling**: Extracts and saves attachments in dedicated folders
- **Security**: Works with Google's App Passwords for enhanced security
- **Batch Processing**: Handles large accounts efficiently with batch processing
- **Progress Tracking**: Shows real-time progress with status bars
- **Detailed Logging**: Creates logs of the archiving process
- **Cross-platform**: Works on Windows, macOS, and Linux

## Prerequisites

- Python 3.6 or higher
- Gmail account with IMAP enabled
- App Password (recommended) or Gmail password

## Installation

1. Clone or download this repository:
   ```
   git clone https://github.com/yourusername/gmail-archiver.git
   cd gmail-archiver
   ```

2. Install the required dependencies:
   ```
   pip install -r requirements.txt
   ```

## Gmail Configuration

Before using the script, you need to configure your Gmail account:

### 1. Enable IMAP in Gmail

1. Log in to your Gmail account
2. Click on the gear icon (⚙️) in the top right and select "See all settings"
3. Go to the "Forwarding and POP/IMAP" tab
4. In the "IMAP access" section, select "Enable IMAP"
5. Click "Save Changes"

### 2. Set Up an App Password (Recommended)

Using an App Password is more secure than using your main Gmail password:

1. Go to your [Google Account](https://myaccount.google.com/)
2. Select "Security"
3. Under "Signing in to Google," select "2-Step Verification" (enable it if not already enabled)
4. Scroll down and select "App passwords" (https://myaccount.google.com/apppasswords)
5. Select "Mail" for the app and your device type
6. Click "Generate"
7. Use the 16-character password generated by Google with this script

## Usage

### Basic Usage

Run the script with:

```bash
python gmail_archiver.py
```

You will be prompted to enter your Gmail address and password.

### Command Line Options

```bash
python gmail_archiver.py --username your.email@gmail.com --output my_archive_folder
```

Available options:

- `--username`: Your Gmail address
- `--output`: Output directory (default: `gmail_archive`)
- `--batch-size`: Number of emails to process in each batch (default: 100)
- `--folders`: Specific folders to archive (default: all folders)

Example with all options:

```bash
python gmail_archiver.py --username your.email@gmail.com --output my_archive --batch-size 200 --folders INBOX Sent "Important Work"
```

## Archive Structure

The script creates an organized directory structure:

```
gmail_archive/
├── INBOX/
│   ├── 2023-01/
│   │   ├── 2023-01-15_14-30-22_sender@example.com_Email_Subject.eml
│   │   ├── attachments/
│   │   │   └── 2023-01-15_14-30-22_Email_Subject_attachments/
│   │   │       ├── document.pdf
│   │   │       └── image.jpg
│   │   └── ...
│   ├── 2023-02/
│   └── ...
├── Sent/
├── Important/
└── ...
```

- Top level: Gmail labels/folders
- Second level: Year-month directories
- Third level: Individual emails (.eml files) and attachments directory

## Email Filename Format

Email files are named using this format:
```
YYYY-MM-DD_HH-MM-SS_sender@example.com_Subject.eml
```

## Viewing .EML Files

The archived emails are saved in .eml format, which can be opened with:

- **Windows**: Windows Mail, Outlook, Thunderbird
- **macOS**: Apple Mail, Outlook, Thunderbird
- **Linux**: Thunderbird, Evolution

## Troubleshooting

### Authentication Issues

- Verify that IMAP is enabled in your Gmail settings
- If using your Gmail password directly, ensure "Less secure app access" is enabled (not recommended)
- For App Passwords, verify you're using the correct 16-character code

### Connection Errors

- Check your internet connection
- Gmail may temporarily block access if you're downloading a large number of emails
  - Wait a few hours before trying again
  - Try reducing the batch size with `--batch-size`

### Missing Emails

- Check your Gmail storage usage; if your account is full, some emails might not be accessible
- Verify the script has permissions to create directories in your selected output location

## Logs

The script creates a log file `gmail_archiver.log` that contains detailed information about the archiving process. Check this file if you encounter any issues.

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Disclaimer

This script is provided as-is, without warranties or guarantees. Always make sure you have proper backup strategies in place for important data.

---

For questions, issues, or contributions, please open an issue on GitHub.